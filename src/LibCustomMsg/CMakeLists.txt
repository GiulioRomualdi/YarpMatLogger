# set target name
set(LIBRARY_TARGET_NAME CustomMsg)

set(${LIBRARY_TARGET_NAME}_THRIFT_HDR
  thrifts/MatrixCollection.thrift
  )

set(generated_libs_dir "${CMAKE_CURRENT_SOURCE_DIR}/autogenerated")

yarp_idl_to_dir(INPUT_FILES ${${LIBRARY_TARGET_NAME}_THRIFT_HDR}
  OUTPUT_DIR ${generated_libs_dir}
  SOURCES_VAR ${LIBRARY_TARGET_NAME}_SRC
  HEADERS_VAR ${LIBRARY_TARGET_NAME}_HDR
  INCLUDE_DIRS_VAR include_dirs)

# add an executable to the project using the specified source files.
add_library(${LIBRARY_TARGET_NAME} ${${LIBRARY_TARGET_NAME}_SRC} ${${LIBRARY_TARGET_NAME}_HDR})

# set_target_properties(${LIBRARY_TARGET_NAME} PROPERTIES VERSION ${${PROJECT_NAME}_VERSION}
#   PUBLIC_HEADER "${${LIBRARY_TARGET_NAME}_HDR}")

add_library(${PROJECT_NAME}::${LIBRARY_TARGET_NAME} ALIAS ${LIBRARY_TARGET_NAME})

# add include directories to the build.
target_include_directories(${LIBRARY_TARGET_NAME} PUBLIC
  "$<BUILD_INTERFACE:${generated_libs_dir}/include>"
  "$<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}>")

target_link_libraries(${LIBRARY_TARGET_NAME} ${YARP_LIBRARIES})

install(TARGETS ${LIBRARY_TARGET_NAME}
        EXPORT  ${PROJECT_NAME}
        LIBRARY       DESTINATION "${CMAKE_INSTALL_LIBDIR}"                            COMPONENT shlib
        ARCHIVE       DESTINATION "${CMAKE_INSTALL_LIBDIR}"                            COMPONENT lib
        RUNTIME       DESTINATION "${CMAKE_INSTALL_BINDIR}"                            COMPONENT bin
        PUBLIC_HEADER DESTINATION "${CMAKE_INSTALL_INCLUDEDIR}/${LIBRARY_TARGET_NAME}" COMPONENT dev)

message(STATUS "Created target ${LIBRARY_TARGET_NAME} for export ${PROJECT_NAME}.")
